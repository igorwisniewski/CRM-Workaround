generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql" // <--- ZMIANA 1: mysql zamiast postgresql
  url      = env("DATABASE_URL")
  // directUrl usuwamy, nie jest potrzebne
}

enum Role {
  USER
  ADMIN
}

model User {
  id    String  @id @default(uuid())
  email String? @unique
  role  Role    @default(USER)
  kolor String?

  createdContacts  Contact[] @relation("CreatedBy")
  assignedContacts Contact[] @relation("AssignedTo")
  createdTasks     Task[]    @relation("TaskCreatedBy")
  assignedTasks    Task[]    @relation("TaskAssignedTo")
}

model Contact {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  imie    String
  etap    String
  email   String?
  telefon String?
  zrodlo  String?
  branza  String?

  // ZMIANA 2: Dodajemy @db.Text do długich pól, bo MySQL ma limity
  opis String? @db.Text

  nazwaFirmy    String?
  rodzajDzialki String?

  potrzebaKlienta String? @db.Text

  formaOpodatkowania String?
  zobowiazania       Json?

  majatekFirmy String? @db.Text

  czyZatrudniaPracownikow String?
  opoznieniaWPlatnosciach String?

  planNaRozwoj String? @db.Text

  stanCywilny           String?
  rozdzielnoscMajatkowa String?

  majatekPrywatny String? @db.Text

  czyBralKredyt10Lat String?

  createdById  String
  createdBy    User   @relation("CreatedBy", fields: [createdById], references: [id])
  assignedToId String
  assignedTo   User   @relation("AssignedTo", fields: [assignedToId], references: [id])

  tasks Task[]
}

model Task {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  nazwa    String
  opis     String?  @db.Text // Tu też warto dać Text
  termin   DateTime
  wykonane Boolean  @default(false)

  contactId String
  contact   Contact @relation(fields: [contactId], references: [id])

  createdById String
  createdBy   User   @relation("TaskCreatedBy", fields: [createdById], references: [id])

  assignedToId String
  assignedTo   User   @relation("TaskAssignedTo", fields: [assignedToId], references: [id])
}
